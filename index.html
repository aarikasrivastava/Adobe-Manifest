<!DOCTYPE html>
<html lang="en">
<head>

    <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js">  </script> 
    <script src="upload_excel.js" ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adobe Manifest </title>
   
</head>
<body>
    <input type="file" id="excel_file">
<script>
    
    function makeTable(array) {
    var table = document.createElement('table');
    table.setAttribute("border","2");
    table.setAttribute("align","center");
    for (var i = 0; i < array.length; i++) {
        var row = document.createElement('tr');
        for (var j = 0; j < array[i].length; j++) {
            var cell = document.createElement('td');
            cell.textContent = array[i][j];
            row.appendChild(cell);
        }
        table.appendChild(row);
    }
    return table;
}
    
    var excel_file = document.getElementById('excel_file');
    excel_file.addEventListener('change', function(){
        readXlsxFile(excel_file.files[0]).then (function(data){
        //console.log(data);
        data[0].push("Difference");
        
        for  (i= 1 ; i<data.length ; i++){
          result = data[i];
          text = result.toString();
          data[i].push((data[i][(data[i].length-1)]-data[i][(data[i].length-2)]));
          var arr= new Array()
          arr[0]=data[0]
          arr[1]=data[i]
          tbl=makeTable(arr);
          html2pdf().from(tbl).toPdf().save(arr[1][0]);
     console.log(result);
     console.log(arr[0][0]);

          
       }
      
        
           
        });
    })
</script>
</body>
</html>
      